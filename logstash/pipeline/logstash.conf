input {
	tcp {
		port => 5000
	}
}

## Add your filters / logstash plugins configuration here
filter {
     grok {
  		match => [ "message", "%{IP:client_ip} %{USER:ident} %{USER:auth} \[%{HTTPDATE:apache_timestamp}\] \"%{WORD:method} /%{NOTSPACE:request_page} HTTP/%{NUMBER:http_version}\" %{NUMBER:server_response} - "%{NOTSPACE:headers}" "%{DATA:user_agent}" %{NOTSPACE:request_id}" ]
	}
	  grok {
  		match => [ "request_page", "(?<operation>(?<=op=)\S*)"]
	}
}

output {
	elasticsearch {
		hosts => "elasticsearch:9200"
	}
}
